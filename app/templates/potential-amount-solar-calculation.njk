{% extends '.layout.njk' %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "./components/macro.njk" import crumbToken %}

{% block pageTitle %}
    Potential grant funding - {{siteTitle}}
{% endblock %}

{% block beforeContent %}
    {{ govukBackLink({
        text: "Back",
        href: backLink,
        attributes: {id: 'linkBack'}
    })}}

{% endblock %}

{% block content %}
    <h1 class="govuk-heading-xl">Potential grant funding</h1>
    <div class="govuk-body">
        You may be able to apply for a grant of up to £{{totalCalculatedGrant}}, based on the estimated cost of £{{totalProjectCost}}

        <div class="govuk-list govuk-list--bullet">
            <ul>
                <li>£{{calculatedGrant}} for building project costs ({{grantPercentage}}% of £{{projectCost}})</li>
                <li>£{{grantFunding}} for solar PV system costs</li>
            </ul>
        </div>

        <details class="govuk-details">
            <summary class="govuk-details__summary">
                <span class="govuk-details__summary-text">
                    How is the solar PV system grant funding calculated?
                </span>
            </summary>
            <div class="govuk-details__text">
                {# breakdown of costs text format #}
                <p>The solar PV system you plan to buy and install has a higher power capacity than 5kW of power per 1,000 birds. </p>
                <p>Based on the building's bird capacity ( {{numberOfBirds}} birds), you can apply 25% of the costs of a solar PV system with a power capacity of up to {{powerCap}}kW.</p>
                <p>This is based on the solar PV system costs ({{solarCost}}) divided by the solar PV system's power capacity ({{energyRating}}kW). With these figures, the cost of the solar PV system is equal to £{{solarCap}} per kW.</p>
                <p>You can apply for grant funding of £{{grantFunding}} for solar PV system costs. This is 25% of £{{cost}} , the amount based on your solar PV system costing £{{solarCap}} per kW, multiplied by the power rating of {{powerCap}}kW.</p>
                <p>You must pay the remaining solar PV system costs over £{{grantFunding}}.</p>
                <h1></h1>
                <table class="govuk-table">
                <caption class="govuk-table__caption govuk-table__caption--l">Solar PV system funding calculation</caption>
                <tbody class="govuk-table__body">
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">{{projectTypeTableText}} <br>
                        <span class = 'govuk-hint'>You told us this <a href='./bird-number'>change the number of birds</a></span>
                    </td>
                    <td class="govuk-table__cell">{{numberOfBirds}}</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">Solar PV system cost<br>
                        <span class = 'govuk-hint'>You told us this <a href='./solar-PV-cost'>change the solar PV system cost</a></span>
                    </td>
                    <td class="govuk-table__cell">£{{solarCost}}</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">This project’s solar PV system power capacity<br>
                        <span class = 'govuk-hint'>You told us this <a href='./solar-power-capacity'>change the solar PV system rating</a></span>
                    </td>
                    <td class="govuk-table__cell">{{energyRating}}kW</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">Solar PV system cost per kW <br>
                        <span class = 'govuk-hint'>£{{solarCost}} divided by {{energyRating}}</span>
                    </td>
                    <td class="govuk-table__cell">£{{solarCap}}</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">Maximum grant-funded solar PV system rating <br>
                        <span class = 'govuk-hint'>5kW for every thousand birds</span>
                    </td>
                    <td class="govuk-table__cell">{{powerCap}}kW</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">Solar PV system costs that grant funding applies to<br>
                        <span class = 'govuk-hint'>£{{solarCap}} multiplied by {{powerCap}}kW</span>
                    </td>
                    <td class="govuk-table__cell">£{{cost}}</td>
                    </tr>
                    <tr class="govuk-table__row">
                    <td class="govuk-table__cell">Potential grant funding for solar PV system <br>
                        <span class = 'govuk-hint'>%25 of {{solarCost}}</span>
                    </td>
                    <td class="govuk-table__cell">£{{grantFunding}}</td>
                    </tr>
                </tbody>
                </table>
                {# table view with hint text, links etc #}
            </div>
        </details>

    </div>

<div class="govuk-grid-row">
    {{ govukWarningText({ 
        text: 'There is no guarantee you will receive a grant',
        iconFallbackText: 'Warning'
    }) }}

<br/><br/>
    <form method="POST" action="{{ formActionPage }}" autocomplete="off" novalidate>
        {{ crumbToken(crumb)}}
        {{ govukButton({
            text: "Continue",
            attributes: {id: "btnContinue"}
        }) }}
    </form>
</div>
{% endblock %}